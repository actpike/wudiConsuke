---
project_name: "視覚的感想入力促進機能実装"
status: "Todo"
owner: "ぴけ"
created_at: "2025-07-28"
updated_at: "2025-07-28"
---

**Project Name:** `視覚的感想入力促進機能実装`
**Creation Date:** `2025-07-28`
**Revision History:**
  - `v1.1 (2025-07-28): 詳細画面のコメント欄ハイライト機能を追加`
  - `v1.0 (2025-07-28): Initial draft`

#### 1. Project Purpose & Background

「その他」項目で評価をつけているユーザーは、通常何かしらのコメントや感想を持っているはずです。しかし、評価は入力したものの感想欄が空の場合、後で感想を忘れてしまうリスクがあります。

この機能は、「その他」評価が0点より大きく、感想が未入力の作品を視覚的にハイライトすることで、ユーザーに感想入力を促し、より充実した作品管理を支援することを目的とします。

#### 2. Scope of Work

**2.1 メイン画面（TOP画面）での視覚的ハイライト機能**
- 作品リストの各行において、以下の条件判定を実装
  - `rating.その他 > 0` （その他評価が0点より大きい）
  - `review === null || review === undefined || review.trim() === ""` （感想が未入力）
- 上記両条件を満たす行の背景色を薄いオレンジ色（`#ffe5b4` または `rgba(255, 229, 180, 0.5)`）に変更

**2.2 詳細画面でのコメント欄ハイライト機能**
- 詳細画面（navigation.js）において、以下の条件判定を実装
  - `rating.その他 > 0` （その他評価が0点より大きい）
  - `review === null || review === undefined || review.trim() === ""` （感想が未入力）
- 上記両条件を満たす場合、感想入力テキストエリアの背景色を薄いオレンジ色（メイン画面と同色）に変更
- 感想入力時または「その他」評価変更時にリアルタイム更新

**2.3 動的表示更新**
- データ変更時（評価更新・感想入力・削除等）のリアルタイム反映
- フィルタリング・ソート時の正常な表示維持
- 画面遷移時（詳細画面から戻る時）の状態復元

**2.4 CSS スタイリング**
- 薄いオレンジ色の背景色定義
- ホバー時の適切な色調整
- 既存のテーブルスタイルとの調和確保

**2.5 JavaScript 実装**
- `popup.js` の `GameListManager` クラス内での実装（メイン画面）
- `updateGameListDisplay()` メソッドでの条件判定追加
- `navigation.js` の詳細画面表示・更新処理での実装（詳細画面）
- データ更新時の自動再描画対応

#### 3. Out of Scope

**3.1 他の評価項目への拡張**
- 「熱中度」「斬新さ」等、他の評価項目でのハイライト機能は対象外
- 複数評価項目の組み合わせ条件は対象外

**3.2 警告メッセージ機能**
- 詳細画面での警告メッセージ表示は対象外
- ポップアップやモーダルでの注意喚起は対象外

**3.3 通知機能**
- デスクトップ通知やポップアップでの警告は対象外
- 音声通知は対象外

**3.4 設定機能**
- ハイライト色のユーザーカスタマイズ機能は対象外
- ハイライト機能のON/OFF設定は対象外

#### 4. Technical Requirements

**4.1 実装対象ファイル**
- `wodicon_helper/js/popup.js` - メイン画面実装
- `wodicon_helper/js/navigation.js` - 詳細画面実装
- `wodicon_helper/css/popup.css` - スタイル定義

**4.2 実装方法**
- CSS クラス `.review-reminder-highlight` を新規定義（テーブル行用）
- CSS クラス `.review-textarea-highlight` を新規定義（テキストエリア用）
- JavaScript で条件判定後、該当要素に動的クラス付与
- 詳細画面では感想テキストエリア要素に直接クラス適用

**4.3 パフォーマンス要件**
- 作品リスト表示時の遅延影響は最小限に抑制
- 100作品表示時でも1秒以内の描画完了

#### 5. Acceptance Criteria

**5.1 基本機能（メイン画面）**
- ✅ 「その他」評価 > 0 かつ 感想未入力の行が薄いオレンジでハイライト
- ✅ 感想入力後、即座にハイライト解除
- ✅ 「その他」評価を0にした場合、即座にハイライト解除

**5.2 基本機能（詳細画面）**
- ✅ 「その他」評価 > 0 かつ 感想未入力時、コメント欄が薄いオレンジでハイライト
- ✅ 感想入力開始時、即座にハイライト解除
- ✅ 「その他」評価変更時、リアルタイムでハイライト状態更新

**5.3 動作確認**
- ✅ フィルタリング（新着・既プレイ等）時の正常表示
- ✅ ソート（作品No・更新日時等）時の正常表示
- ✅ 詳細画面からの戻り時の正常表示

**5.4 UI/UX**
- ✅ 背景色が読みやすさを損なわない
- ✅ ホバー時の視覚的フィードバック正常
- ✅ 既存のデザインとの調和

#### 6. Testing Requirements

**6.1 機能テスト**
- 「その他」評価のみ入力した新規作品での表示確認（メイン画面・詳細画面）
- 感想入力後のハイライト解除確認（メイン画面・詳細画面）
- 「その他」評価変更時のリアルタイム更新確認（詳細画面）
- 複数条件下での正常動作確認

**6.2 回帰テスト**
- 既存のフィルタリング機能への影響確認
- 既存のソート機能への影響確認
- データ保存・読み込み機能への影響確認

#### 7. Implementation Notes

**7.1 実装優先度**
1. CSS クラス定義（最優先）
2. JavaScript 条件判定ロジック
3. 動的クラス付与処理
4. テスト・調整

**7.2 考慮事項**
- `constants.js` の `RATING_CATEGORIES` 定数活用
- 既存の `hasUserData()` メソッドとの整合性確保
- null/undefined 値の安全な処理

#### 8. Timeline

**Phase 1: 設計・実装** (1-2時間)
- CSS クラス定義
- JavaScript ロジック実装

**Phase 2: テスト・調整** (30分-1時間)  
- 動作確認
- スタイル微調整

**Total Estimated Time:** 3-4時間

#### 9. Risks & Mitigation

**Risk 1: パフォーマンス影響**
- Mitigation: 効率的な条件判定ロジック実装

**Risk 2: 既存機能への副作用**
- Mitigation: 段階的実装と回帰テスト実施

**Risk 3: 視認性への影響**
- Mitigation: 複数の色候補でユーザビリティテスト実施